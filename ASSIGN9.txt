EXPT. NO. : 9 
TITLE: On chip ADC Programming With PIC Micro Controller 
 
#include<p18f4550.h> 
#include”vector_relocate.h” 
 
#define LCD_DATA    PORTD               //LCD data port               //LCD signal port 
#define en          PORTEbits.RE2      // enable signal 
#define rw          PORTEbits.RE1      // read/write signal 
#define rs          PORTEbits.RE0     // register select signal 
 
Void LCD_cmd(unsigned char cmd); 
Void myMsDelay (unsigned int time) 
{ 
 Unsigned int i, j; 
 For (i = 0; i < time; i++) 
  For (j = 0; j < 665; j++); 
} 
 
Void init_LCD(void) 
{ 
    LCD_cmd(0x38);      // initialization of 16X2 LCD in 8bit mode 
    myMsDelay(15); 
 
    LCD_cmd(0x01);      // clear LCD 
    myMsDelay(15); 
 
    LCD_cmd(0x0E);      // cursor off 
    myMsDelay(15); 
 
    LCD_cmd(0x80);       
    myMsDelay(15); 
 
          
 
} 
//Function to pass command to the LCD 
Void LCD_cmd(unsigned char cmd) 
PUNE INSTITUTE OF COMPUTER TECHNOLOGY, PUNE - 411043 
Department of Electronics & Telecommunication Engineering 
{ 
} 
LCD_DATA = cmd; 
Rs = 0; 
Rw = 0; 
En = 1; 
myMsDelay(15); 
en = 0; 
myMsDelay(15); 
//Function to write data to the LCD 
Void LCD_write(unsigned char data) 
{ 
LCD_DATA = data; 
Rs = 1; 
Rw = 0; 
En = 1; 
myMsDelay(15); 
en = 0; 
myMsDelay(15); 
} 
Void main(void) 
{ 
Unsigned int val[4],ADC_Result=0,var; 
Unsigned char i,str[]=”Result:”; 
TRISD = 0x00;         //Configuring PORTD as output  
TRISE=0; 
TRISA=0xFF; 
Init_LCD(); 
// ADC Initialization 
ADCON1=0x0C;  
ADCON2=0x8E; 
MC (T.E.E &TC Engg.) 2024_2025                                                                                                                                                               
1.2 
PUNE INSTITUTE OF COMPUTER TECHNOLOGY, PUNE - 411043 
Department of Electronics & Telecommunication Engineering 
ADCON0=0X09; //Turn ON ADC module 
LCD_cmd(0x80); 
For(i=0;str[i]!=’\0’;i++) 
{ 
LCD_write(str[i]); 
myMsDelay(200); 
} 
While(1) 
{ 
ADCON0bits.GO=1; 
While(ADCON0bits.GO==1); 
Var=((unsigned int)ADRESH) << 8; 
ADC_Result=var+ADRESL; 
For(i=0;i<4;i++) 
{ 
Val[i]=ADC_Result%0x0A; 
Val[i]=val[i]+0x30; 
ADC_Result=ADC_Result/0x0A; 
} 
LCD_cmd(0x87); // LCD command to set DDRAM address. (DDRAM: Display Data RAM) 
LCD_write(val[3]); 
LCD_write(val[2]); 
LCD_write(val[1]); 
LCD_write(val[0]); 
} 
} 
