EXPT. NO.: 4  
TITLE: Interfacing stepper motor with 89C51 
 
Code 1 : Anticlockwise rotation  
 #include <reg51.h> 
 void msdelay(unsigned int); 
 void main (void){ 
     while(1){ 
         P1 = 0x03;  
         msdelay(50); 
         P1=0x09; 
         msdelay(50); 
         P1=0x0C; 
         msdelay(50); 
         P1=0x06; 
         msdelay(50); 
     } 
 } 
  
 void msdelay(unsigned int itime){ 
        unsigned int i,j; 
     for(i=0;i<itime;i++){ 
         for(j=0;j<1275;j++){ 
         } 
     } 
 } 
 PUNE INSTITUTE OF COMPUTER TECHNOLOGY, PUNE - 411043 
       Department of Electronics & Telecommunication Engineering 
 
MC (T.E.E &TC Engg.) 2024_2025                                                                                                                                                               1.2 
 
 
 
Code 2 : Clockwise rotation  
 #include <reg51.h> 
 void msdelay(unsigned int); 
 void main (void){ 
     while(1){ 
         P1 = 0x06;  
         msdelay(500); 
         P1=0x0C; 
         msdelay(500); 
         P1=0x09; 
         msdelay(500); 
         P1=0x03; 
         msdelay(500); 
     } 
 } 
  
 void msdelay(unsigned int itime){ 
        unsigned int i,j; 
 PUNE INSTITUTE OF COMPUTER TECHNOLOGY, PUNE - 411043 
       Department of Electronics & Telecommunication Engineering 
 
MC (T.E.E &TC Engg.) 2024_2025                                                                                                                                                               1.3 
 
     for(i=0;i<itime;i++){ 
         for(j=0;j<1275;j++){ 
         } 
     } 
 } 
 
 
Code 3 : 90 degree rotation 
 #include <reg51.h> 
 void msdelay(unsigned int); 
 void main (void){ 
     unsigned int k; 
     for(k = 0 ; k < 3 ; k++){ 
         P1 = 0x03;  
         msdelay(50); 
         P1=0x09; 
         msdelay(50); 
         P1=0x0C; 
         msdelay(50); 
         P1=0x06; 
 PUNE INSTITUTE OF COMPUTER TECHNOLOGY, PUNE - 411043 
       Department of Electronics & Telecommunication Engineering 
 
MC (T.E.E &TC Engg.) 2024_2025                                                                                                                                                               1.4 
 
         msdelay(50); 
     } 
     msdelay(50000); 
 } 
  
 void msdelay(unsigned int itime){ 
        unsigned int i,j; 
     for(i=0;i<itime;i++){ 
         for(j=0;j<1275;j++){ 
         } 
     } 
 } 